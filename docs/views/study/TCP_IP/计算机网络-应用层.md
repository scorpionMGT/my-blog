---
title: 计算机网络-应用层
date: 2022-04-15
tags:
  - 计算机网络
categories:
  - 计算机网络
---

# 计算机网络-应用层

传输层是为了应用进程之间的通信服务的，但是在不同的网络进程之间还需要不同的通信规则，因此在传输层还有一层应用层，应用层的协议：

1. 应用进程交换的报文类型，如请求报文和响应报文
2. 各个报文类型的语法，如报文中的各个字段和其详细描述
3. 字段的语义，各个字段的信息含义
4. 进程何时，如何发送报文，以及对报文的响应规则

**互联网公共领域的标准应用的应用层协议是由 RFC 文档定义的**
应用层协议有几个重点：

1. 域名系统 DNS---从域名中解析处 IP 地址
2. 万维网和 HTTP 协议
3. 电子邮件的传送过程
4. 动态主机配置协议 DHCP 的特点
5. P2P 文件系统

## 1 域名系统 DNS

域名系统（domain name system）是分布式联机数据系统，采用客户服务器模式，DNS 的大多数名字都是在本地解析，仅有少量的需要在互联网上进行解析。

**域名解析到 IP 地址的过程：当某个应用进程需要把主机名解析为 IP 地址时，该应用进程就调用解析程序，并成为 DNS 的一个客户，把带解析的域名放到 DNS 请求报文中，以 UDP 用户数据报方式发给本地域名服务器，本地域名服务器查找到 IP 地址后，将 IP 地址放在回答报文中作为返回，应用进程获得目的主机 IP 之后即可进行通信**

### 域名的结构

    www.baidu.com

    www 是三级域名
    baidu 是二级域名
    com 时一级域名或者叫顶级域名

1. 域名不区分大小写
2. 符号中除（-）以外的特殊字符都不可以使用
3. 由多个标号组成的完整域名总共不超过 255 个

### 顶级域名的分类

1. 国家顶级域名 .cn 等
2. 通用顶级域名 .com, .gov 等

![域名空间](https://s1.ax1x.com/2022/04/19/L0tblT.png)

### 域名服务器

一个域名服务器所负责的范围叫做区，每个区设置相应的权限域名服务器，用来保存该区的所有的主机的域名到 IP 地址的映射。

![分布式域名服务器](https://s1.ax1x.com/2022/04/19/L0dobF.png)

1. 根域名服务器，是层次最高的域名服务器，也是最重要的服务器，如果所有的根域名服务器都瘫痪了，那么所有的互联网中的 DNS 都无法工作了
2. 顶级域名服务器，这些域名服务器管理顶级域名服务器注册的所有二级域名
3. 权限域名服务器，就是一个区域的域名服务器，当一个权限域名服务器不能找到域名对应的 IP, 就会告诉发出 DNS 请求的客户下一步应该查询哪一个权限域名服务器
4. 本地域名服务器，一台主机发出 DNS 域名请求时，这个查询请求先发送给本地域名服务器，为提高域名服务器可靠性，DNS 域名服务器都把数据复制到几个服务器来保存，其中是一个主域名服务器，还有其他辅助域名服务器，主域名服务器定期把数据复制到辅助域名服务器中，更改只会对主域名服务器生效，保证数据的一致性
5. **主机向服务器查询通常是采用递归查询**，指的是主机查询本地域名服务器不知道 IP 地址多少，那么本地域名服务器充当 DNS 客户，向其他根域名服务器继续查询（替该主机继续查询），而不是让该主机进行下一步的查询
6. **本地域名服务器向根域名服务器的查询通常是采用迭代查询** 本地域名服务器向其他根域名服务器发送请求报文时，根域名服务器要么给出所要查询的 IP 地址，要么告诉本地域名服务器接下来应该查询哪个跟域名服务器，而不是替本地域名服务器进行下一步的查询

![迭代查询和递归查询](https://s1.ax1x.com/2022/04/19/L0vCjA.png)

## 2 文件传送协议 FTP（files transfer protocal）是网络传送文件的协议，FTP 提供交互式的方式是基于 TCP 的，基于 UDP 的简单文件传输协议 TFTP

FTP 和 TFTP 的特点：若要存取一个文件，就必须获得本地文件的副本，若要修改文件，只能对文件的副本进行修改，然后将文件的副本回传到原节点

### FTP 工作的原理

FTP 使用客服服务器模式，一个 FTP 可以同时处理多个客户进程，FTP 的服务器进程大概由两大部分组成： 一个主进程，负责接收新的请求，另一个是若干个从属进程，负责单个请求
主进程的工作步骤：

1.  打开熟知端口，使得客户进程能够连接上
2.  等待客户进程发出连接请求
3.  启动从属进程处理客户进程发来的请求，从属进程对客户进程请求处理完毕之后即终止
4.  回到等待状态，继续接受其他客户发出的请求，主进程和从属进程的处理是并行的

![FTP的连接](https://s1.ax1x.com/2022/04/19/LBihAs.png)

图中服务器有两个从属进程：控制进程和数据传送进程，服务器主进程并没有画出来，进行文件传输时，c/s 需要建立两个并行 TCP 连接：_控制连接和数据连接_，控制连接始终打开，FTP 客户端发出的传送请求，通过控制连接发送给服务器端的控制进程，但是控制进程并不用来传送文件，实际用于传输文件的是 数据连接，FTP 服务器控制进程收到客户端发送来的文件传输请求之后就创建数据传送进程和数据连接，用来连接客户端和服务端的数据传输进程。

### 简单文件传输协议 TFTP

TFTP 也是客户服务器模式，但是它是基于 UDP 协议，因此不支持交互，需要有自己的差错改正措施

### 远程终端协议 telnet

用户通过 telnet 就可以通过 TCP 连接注册（即登陆）到远地的另一台主机上，telnet 可以将用户的输入传送到远程主机上，同时也可以将远程的主机的输出通过 TCPP 连接返回到用户屏幕上，这种服务是透明的，这种协议感觉像是用户的显示器和键盘连接在远程主机上，因此这种协议也称之为*终端仿真协议*

## 3 万维网 www (world wide web)

### 统一资源定位符 URL

统一资源定位符的一般格式：
  
 <协议>://<主机>:<端口>/<路径>
  


### 超文本传输协议 HTTP

从层次的角度来看，HTTP 是面向事务（一系列的信息交换）的应用层协议，它是万维网上能够可靠的交换文件的重要基础

1. HTTP 本身是无连接的， HTTP 使用了 TCP 可靠传输协议
2. HTTP 协议是无状态的
3. 浏览器大概能打开 5-10 个并行的 TCP 连接，HTTP/1.1 它使用持续连接就是在服务器发送响应之后还是会保留一段时间的连接，使同一个客户可以继续在该条连接上传输 HTTP 请求报文和响应报文，目前主流浏览器都默认支持 HTTP/1.1

### HTTP 的报文结构

![响应报文和请求报文](https://s1.ax1x.com/2022/04/19/LDeTNF.png)

HTTP 请求报文的方法：

![8个请求方法](https://s1.ax1x.com/2022/04/19/LDuB0x.png)
